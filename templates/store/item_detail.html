{% extends 'main/main.html' %}

{% block opengraph %}

{% for image in chargersitems_images|get_item:item.slug|slice:":1" %}
<meta property="og:title" content="{{item.title}}" />
<meta property="og:description" content="{{item.small_description}}" />
<meta property="og:url" content="https://www.evhub.ua/" />
<meta property="twitter:image" content="{{ request.scheme }}://{{ request.get_host }}{{image}}" />
{% endfor %}

{% endblock %}

{% block title %}
{{item.title}}
{% endblock %}

{% block content %}
<div class="container mt-2">
    <small class="mb-1 opacity-75 bg-light" style="font-size: small;">
        <a href="/" class="link-dark">Головна
            <svg xmlns="http://www.w3.org/2000/svg" width="17" height="17" fill="orange" class="bi bi-house-fill mb-1" viewBox="0 0 16 16">
            <path d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L8 2.207l6.646 6.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293z"/>
            <path d="m8 3.293 6 6V13.5a1.5 1.5 0 0 1-1.5 1.5h-9A1.5 1.5 0 0 1 2 13.5V9.293z"/>
            </svg></a> <span class="fw-semibold fs-6 m-1">></span>
        {% if item.category.slug == 'accessories' %}
        <a class="link-dark" href="{% url 'store' %}?ac='accessories_store'">Аксесуари</a>
        {% else %}
        <a class="link-dark" href="{% url 'store' %}">Всі товари</a>
        {% endif %}
        <span class="fw-semibold fs-6 m-1">></span> <span>{{item.title}}</span>
    </small>
</div>
<div class="mx-1 mt-1 p-2 text-center">
    <h6 class="card-title display-6">{{item.title}}</h6>
</div>
<br>
{% if item.product_article %}
<div class="mx-1 mb-1 text-center">
    <p class="p-2 d-inline bg-light">Артикул: {{item.product_article}}</p>
</div>
{% endif %}
<div class="row mx-1 gx-3 d-flex justify-content-center">

<!--    photo gallery if user is pc version-->
    {% if not user_agent.is_mobile %}
    <div class="col-1">
        <div class="card example-1 border-0 rounded-0 overflow-auto" style="max-height: 500px;">
            {% for image in chargersitems_images|get_item:item.slug|slice:"1:" %}
            <div class="thumbnail border-0" data-bs-target="#carouselExampleFade" data-bs-slide-to="{{ forloop.counter }}">
                <img src="{{ image }}" alt="Thumbnail" class="img-fluid">
            </div>
            {% endfor %}
        </div>
    </div>
    {% endif %}

    <div class="col-xxl-4 col-lg-6 col-md-10 col-sm-12">
       <div class="card border-0">
           <div id="carouselExampleFade" class="carousel slide carousel-dark carousel-slide mx-1" data-bs-interval="50000" data-bs-touch="true" data-bs-ride="carousel">
              <div class="carousel-inner">
                  <div class="carousel-item active">
                      {% if chargersitems_images|get_item:item.slug %}
                          {% for image in chargersitems_images|get_item:item.slug|slice:":1" %}
                          <img src="{{ image }}" class="d-block w-100" alt="...">
                          <div class="position-absolute top-0 end-0 p-2 opacity-50">
                              <a href="{{ image }}" class="link-secondary">
                                  <button class="zoomButton btn btn-lg">
                                      <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor" class="bi bi-zoom-in" viewBox="0 0 16 16">
                                          <path fill-rule="evenodd" d="M6.5 12a5.5 5.5 0 1 0 0-11 5.5 5.5 0 0 0 0 11M13 6.5a6.5 6.5 0 1 1-13 0 6.5 6.5 0 0 1 13 0"/>
                                          <path d="M10.344 11.742c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1 6.538 6.538 0 0 1-1.398 1.4z"/>
                                          <path fill-rule="evenodd" d="M6.5 3a.5.5 0 0 1 .5.5V6h2.5a.5.5 0 0 1 0 1H7v2.5a.5.5 0 0 1-1 0V7H3.5a.5.5 0 0 1 0-1H6V3.5a.5.5 0 0 1 .5-.5"/>
                                      </svg>
                                  </button>
                              </a>
                          </div>
                          {% endfor %}
                      </div>
                      {% for image in chargersitems_images|get_item:item.slug|slice:"1:" %}
                      <div class="carousel-item">
                          <img src="{{ image }}" class="d-block w-100" alt="...">
                          <div class="position-absolute top-0 end-0 p-2 opacity-50">
                              <a href="{{ image }}" class="link-secondary">
                                  <button class="zoomButton btn btn-lg">
                                      <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor" class="bi bi-zoom-in" viewBox="0 0 16 16">
                                          <path fill-rule="evenodd" d="M6.5 12a5.5 5.5 0 1 0 0-11 5.5 5.5 0 0 0 0 11M13 6.5a6.5 6.5 0 1 1-13 0 6.5 6.5 0 0 1 13 0"/>
                                          <path d="M10.344 11.742c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1 6.538 6.538 0 0 1-1.398 1.4z"/>
                                          <path fill-rule="evenodd" d="M6.5 3a.5.5 0 0 1 .5.5V6h2.5a.5.5 0 0 1 0 1H7v2.5a.5.5 0 0 1-1 0V7H3.5a.5.5 0 0 1 0-1H6V3.5a.5.5 0 0 1 .5-.5"/>
                                      </svg>
                                  </button>
                              </a>
                          </div>
                      </div>
                      {% endfor %}
                  {% endif %}
                  <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleFade" data-bs-slide="prev">
                      <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                      <span class="visually-hidden">Previous</span>
                  </button>
                  <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleFade" data-bs-slide="next">
                      <span class="carousel-control-next-icon" aria-hidden="true"></span>
                      <span class="visually-hidden">Next</span>
                  </button>
              </div>

<!--           photo gallery mob version-->
               {% if user_agent.is_mobile %}
               <div class="row">
                   <div class="card border-0">
                       <div class="card-body d-flex flex-row overflow-auto flex-nowrap">
                           {% for image in chargersitems_images|get_item:item.slug|slice:"1:" %}
                           <div class="col-3 col-lg-2 thumbnails">
                               <div class="thumbnail" data-bs-target="#carouselExampleFade" data-bs-slide-to="{{ forloop.counter }}">
                                   <img src="{{ image }}" alt="Thumbnail" class="img-fluid">
                               </div>
                           </div>
                           {% endfor %}
                       </div>
                   </div>
               </div>
               {% endif %}

           </div>
       </div>
    </div>
    <div class="col-lg-4 col-sm-12">
        <div class="card border-0">
            <div class="card-body bg-light">
                <p>{{item.small_description}}</p>
            </div>
            <div class="card-body mt-2">
                <div class="row">
                    {% if item.sale_price %}
                    <div class="col-6 d-flex align-items-center">
                        <p class="fs-4 fw-semibold text-success text-start">
                            {{sale_price}} {{currency_token}}
                        </p>
                        <s class="fs-5 fw-semibold text-danger opacity-50 text-end ms-1"><small>{{currency_price}} {{currency_token}}</small></s>
                    </div>
                    {% else %}
                    <div class="col-5 d-flex align-items-center">
                        <p class="fs-4 fw-semibold">{{currency_price}} {{currency_token}}</p>
                    </div>
                    {% endif %}
                    {% if item.sale_price %}
                    <div class="col-6 d-flex justify-content-end fs-6">
                    {% else %}
                    <div class="col-7 d-flex justify-content-end fs-4">
                    {% endif %}
                        {% if item.in_stock == 'True' %}
                        <p class="mt-2 fw-light pb-2">
                            В наявності
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="green" class="bi bi-check-circle" viewBox="0 0 16 16">
                                <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"/>
                                <path d="M10.97 4.97a.235.235 0 0 0-.02.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-1.071-1.05"/>
                            </svg>
                        </p>
                        {% elif item.in_stock == 'False' %}
                            {% if item.sale_price %}
                            <p class="mt-2 fw-light fs-5 pb-2">
                            {% else %}
                            <p class="mt-2 fw-light pb-2">
                                Немає в наявності
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="red" class="bi bi-x-circle" viewBox="0 0 16 16">
                                    <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"/>
                                    <path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708"/>
                                </svg>
                            </p>
                            {% endif %}
                        {% elif item.in_stock == 'pending' %}
                        <p class="mt-2 fw-light pb-2">
                            Під замовлення
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="orange" class="bi bi-info-circle-fill" viewBox="0 0 16 16">
                                <path d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16m.93-9.412-1 4.705c-.07.34.029.533.304.533.194 0 .487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703 0-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381 2.29-.287zM8 5.5a1 1 0 1 1 0-2 1 1 0 0 1 0 2"/>
                            </svg>
                        </p>
                        {% endif %}
                    </div>
                </div>
                <div class="row custom">
                    <div class="col-8 col-lg-8">
                        {% if item_exist_cart %}
                        <button type="button" class="btn btn-success rounded-0 opacity-75 btn-lg"
                            hx-get="{% url 'cart' %}"
                            hx-target="#contact-modals-here"
                            hx-trigger="click"
                            data-bs-toggle="modal"
                            data-bs-target="#contact-modals-here">
                            Додано до кошика
                        </button>

                        {% else %}

<!--                    Якшо товар не в наявності-->
                        {% if item.in_stock == 'False' %}
                        <button type="button" class="btn btn-danger rounded-0 opacity-75 btn-lg"
                            hx-get="{% url 'order_quick' item.slug %}"
                            hx-target="#contact-modals-here"
                            hx-trigger="click"
                            data-bs-toggle="modal"
                            data-bs-target="#contact-modals-here">
                            Додати до кошика
                        </button>

                        {% else %}
                        <form id="add-cart-button" class="cart-from"
                            hx-post="{% url 'add_to_cart' item.slug 'add-cart-button' %}"
                            hx-trigger="click"
                            hx-target="#header_menu_cart_button"
                            hx-swap="outerHTML transition:true">

                            {% csrf_token %}
                            <button type="button" class="btn btn-warning rounded-0 opacity-75 btn-lg">
                                Додати до кошика
                            </button>
                        </form>
                        {% endif %}
                        {% endif %}
                    </div>
                    {% if item_exist_favorites %}
                    <div class="col-2 col-lg-2 d-flex justify-content-end">
                        <div data-toggle="tooltip" data-placement="top" title="переглянути">
                            <button type="submit" class="btn btn-white rounded-pill bg-light opacity-75 btn-sm">
                                <a href="{% url 'favorites' %}">
                                {% load static %}<img src="{% static 'store/Like 04.svg' %}" width="50" height="40">
                                </a>
                            </button>
                        </div>
                    </div>
                    {% else %}
                    <div class="col-2 col-lg-2 d-flex justify-content-end">
                        <form id="favorite-button"
                            hx-post="{% url 'add_to_favorites' %}"
                            hx-trigger="click"
                            hx-swap="none transition:true">

                            {% csrf_token %}
                            <input type="hidden" name="slug" value="{{item.slug}}">
                            <button type="submit" class="btn btn-white rounded-pill bg-light opacity-75 btn-sm">
                                {% load static %}<img src="{% static 'store/Like 01.svg' %}" width="49" height="39">
                            </button>
                        </form>
                    </div>
                    {% endif %}
                    {% if item_exist_comparison %}
                        <div class="col-2 col-lg-2 d-flex justify-content-end">
                        <div data-toggle="tooltip" data-placement="top" title="переглянути">
                            <button type="submit" class="btn btn-white rounded-pill bg-light opacity-75 btn-sm">
                                <a href="{% url 'comparison' %}" type="submit">
                                    {% load static %}<img src="{% static 'store/Comparing 03.svg' %}" width="35" height="40">
                                </a>
                            </button>
                        </div>
                    </div>
                    {% else %}
                    <div class="col-2 col-lg-2 d-flex justify-content-end">
                        <form id="comparison_active"
                            hx-post="{% url 'add_to_comparison' %}"
                            hx-trigger="click"
                            hx-swap="none transition:true">

                            {% csrf_token %}
                            <input type="hidden" name="slug" value="{{item.slug}}">
                            {% if user_agent.is_mobile %}
                            <input type="hidden" name="user_agent" value="True">
                            {% elif user_agent.is_tablet %}
                            <input type="hidden" name="user_agent" value="True">
                            {% else %}
                            <input type="hidden" name="user_agent" value="False">
                            {% endif %}
                            <button type="submit" class="btn btn-white rounded-pill bg-light opacity-75 btn-sm">
                                {% load static %}<img src="{% static 'store/Comparing 00.svg' %}" width="35" height="40">
                            </button>
                        </form>
                    </div>
                    {% endif %}
                    <div class="col-12 col-lg-12 d-flex justify-content-center mt-2">
                        <button type="button" class="btn btn-outline-dark border-top-0 border-start-0 border-end-0 rounded-0 opacity-75 btn-lg"
                        hx-get="{% url 'order_quick' item.slug %}"
                        hx-target="#contact-modals-here"
                        hx-trigger="click"
                        data-bs-toggle="modal"
                        data-bs-target="#contact-modals-here">
                            Купити товар в один клік
                        </button>
                    </div>
                    <div class="row">
                       <div class="card border-0 mt-2">
                           <div class="card-body d-flex flex-row overflow-auto">
                               {% for feature in features %}
                                    <p class="d-flex align-items-center me-5"><badge class="border-0 border-bottom border-2 text-wrap bg-white text-dark text-nowrap border-opacity-75 fw-light
                                    {% cycle 'border border-warning' 'border border-success' 'border border-primary' 'border border-info' 'border border-danger' %}">{{feature}}</badge></p>
                                {% endfor %}
                           </div>
                       </div>
                        {% if item.category.slug == 'accessories' %}
                        <div class="card border-0">
                            <p class="text-center fs-5 ms-3 bg-light">Характеристики:</p>
                            <div class="d-flex justify-content-center ms-3">
                                <ul class="list-group list-group-flush text-center small">
                                    <li class="list-group-item">Розмір: {{item.size}}</li>
                                    <li class="list-group-item">Матеріал: {{item.material}}</li>
                                    <li class="list-group-item">Тип: {{item.get_accessories_type_display}}</li>
                                </ul>
                            </div>
                        </div>
                        {% endif %}
                   </div>
                </div>
            </div>
        </div>
    </div>
    <ul class="nav nav-tabs col-11 col-xxl-9" id="myTab" role="tablist">
      <li class="nav-item" role="presentation">
        <button class="nav-link active link-secondary" id="description-tab" data-bs-toggle="tab" data-bs-target="#description-tab-pane" type="button" role="tab" aria-controls="home-tab-pane" aria-selected="true">Опис</button>
      </li>
      {% if item.category.slug != 'accessories' %}
      <li class="nav-item" role="presentation">
        <button class="nav-link link-secondary" id="specs-tab" data-bs-toggle="tab" data-bs-target="#specs-tab-pane" type="button" role="tab" aria-controls="profile-tab-pane" aria-selected="false">Характеристики</button>
      </li>
      {% endif %}
      {% if item.category.slug != 'accessories' %}
      <li class="nav-item" role="presentation">
        <button class="nav-link link-secondary" id="accessories-tab" data-bs-toggle="tab" data-bs-target="#accessories-tab-pane" type="button" role="tab" aria-controls="contact-tab-pane" aria-selected="false">Аксесуари</button>
      </li>
      {% endif %}
    </ul>
    <div class="tab-content col-11 col-xxl-9 p-2 mt-2" id="myTabContent">
        <div class="tab-pane fade show active" id="description-tab-pane" role="tabpanel" aria-labelledby="home-tab" tabindex="0">{{item.description | safe}}</div>
            <div class="tab-pane fade" id="specs-tab-pane" role="tabpanel" aria-labelledby="profile-tab" tabindex="0">
                <ul class="list-group list-group-flush text-center small">
                    <li class="list-group-item">Тип роз'єму: {{item.type}}</li>
                    <li class="list-group-item">Потужність, ампери: {{item.power_amps}} A</li>
                    <li class="list-group-item">Потужність, кВт: {{item.power}} кВт</li>
                    <li class="list-group-item">Кількість фаз: {{item.phases}}</li>
                    <li class="list-group-item">Довжина кабелю: {{item.cable_length}} метрів</li>
                    <li class="list-group-item">Формфактор: {{item.form}}</li>
                    <li class="list-group-item">Захист від вологи: {{item.protection}}</li>
                    <li class="list-group-item">Гарантія: {{item.guarantee}}</li>
                    <li class="list-group-item">Країна виробник: {{item.country}}</li>
                    <li class="list-group-item">Бренд: {{item.brand}}</li>
                </ul>
            </div>
        <div class="tab-pane fade opacity-75" id="accessories-tab-pane" role="tabpanel" aria-labelledby="contact-tab" tabindex="0">
            <div class="d-flex justify-content-center mt-5">
                {% for model in item.model.all %}
                <div class="spinner-grow text-warning" role="status"
                    hx-get="{% url 'item_detail_accessories' model item.slug %}"
                    hx-ext="loading-states"
                    hx-target="#accessories-tab-pane"
                    hx-trigger="revealed"
                    hx-swap="innerHTML transition:true">
                    <span class="visually-hidden">Loading...</span>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>
</div>
{% endblock %}